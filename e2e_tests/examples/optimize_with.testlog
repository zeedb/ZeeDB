# redundant_with_clause_with_projection
ok: explain with foo as (select customer_id, 1 as r from customer) select customer_id, r from foo
plan                                                                                                                          
Script
	CreateTempTable foo customer_id INT64 r INT64
		Map foo.r:1 customer.customer_id
			SeqScan customer
	GetTempTable foo

# redundant_with_clause
ok: explain with foo as (select * from customer) select customer_id from foo
plan                                                                                                                                                                                
Script
	CreateTempTable foo customer_id INT64 person_id INT64 store_id INT64 account_number INT64 modified_date TIMESTAMP
		SeqScan customer
	Map foo.customer_id
		GetTempTable foo

# remove_with
ok: explain with foo as (select * from customer) select * from foo
plan                                                                                                                                                          
Script
	CreateTempTable foo customer_id INT64 person_id INT64 store_id INT64 account_number INT64 modified_date TIMESTAMP
		SeqScan customer
	GetTempTable foo

# unused_with
ok: explain with foo as (select 1 as a) select 2 as b
plan                                                                                              
Script
	CreateTempTable foo a INT64
		Map foo.a:1
			TableFreeScan
	Map $query.b:2
		TableFreeScan

# use_with_clause_twice
ok: explain with foo as (select customer_id, store_id from customer) select f1.customer_id, f2.customer_id from foo f1, foo f2 where f1.store_id = f2.store_id
plan                                                                                                                                                                                                                                                                                                                               
Script
	CreateTempTable foo customer_id INT64 store_id INT64
		SeqScan customer
	Map foo.customer_id foo.customer_id
		HashJoin Inner (Equal foo.store_id foo.store_id)
			Exchange $hash
				Map $hash:(Hash foo.store_id), ..
					GetTempTable foo
			Exchange $hash
				Map $hash:(Hash foo.store_id), ..
					GetTempTable foo

# use_with_project_twice
ok: explain with foo as (select *, 1 as r from customer) select f1.customer_id, f2.customer_id from foo f1, foo f2 where f1.r = f2.r
plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
Script
	CreateTempTable foo customer_id INT64 person_id INT64 store_id INT64 account_number INT64 modified_date TIMESTAMP r INT64
		Map foo.r:1 customer.customer_id customer.person_id customer.store_id customer.account_number customer.modified_date
			SeqScan customer
	Map foo.customer_id foo.customer_id
		HashJoin Inner (Equal foo.r foo.r)
			Exchange $hash
				Map $hash:(Hash foo.r), ..
					GetTempTable foo
			Exchange $hash
				Map $hash:(Hash foo.r), ..
					GetTempTable foo

# use_with_select_star_twice
ok: explain with foo as (select * from customer) select f1.customer_id, f2.customer_id from foo f1, foo f2 where f1.store_id = f2.store_id
plan                                                                                                                                                                                                                                                                                                                                                                                            
Script
	CreateTempTable foo customer_id INT64 person_id INT64 store_id INT64 account_number INT64 modified_date TIMESTAMP
		SeqScan customer
	Map foo.customer_id foo.customer_id
		HashJoin Inner (Equal foo.store_id foo.store_id)
			Exchange $hash
				Map $hash:(Hash foo.store_id), ..
					GetTempTable foo
			Exchange $hash
				Map $hash:(Hash foo.store_id), ..
					GetTempTable foo

