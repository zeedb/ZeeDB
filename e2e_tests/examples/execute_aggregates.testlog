setup: create table booleans (x boolean);
setup: create table integers (x int64);
setup: create table floats (x float64);
setup: create table dates (x date);
setup: create table timestamps (x timestamp);
setup: create table strings (x string);
setup: insert into booleans values (true), (true), (false), (null);
setup: insert into integers values (1), (1), (2), (3), (null);
setup: insert into floats values (1.0), (2.0), (3.0), (null);
setup: insert into dates values (date '2000-01-01'), (date '2000-01-02'), (date '2000-01-03'), (null);
setup: insert into timestamps values (timestamp '2000-01-01'), (timestamp '2000-01-02'), (timestamp '2000-01-03'), (null);
setup: insert into strings values ('1'), ('1'), ('2'), ('3'), (null);
# simple aggregate counts
ok: select any_value(x), count(x), count(*) from integers
$agg1 $agg2 $agg3
NULL  4     5    

ok: select any_value(x), count(x), count(*) from strings
$agg1 $agg2 $agg3
NULL  4     5    

# simple aggregate boolean
ok: select logical_and(x), logical_or(x), max(x), min(x) from booleans
$agg1 $agg2 $agg3 $agg4
false true  true  false

# simple aggregate int
ok: select max(x), min(x), sum(x) from integers
$agg1 $agg2 $agg3
3     1     7    

# simple aggregate float
ok: select max(x), min(x), sum(x) from floats
$agg1 $agg2 $agg3
3     1     6    

# group by aggregate
ok: select x, sum(x) from integers group by 1 order by 1
x    $agg1
NULL NULL 
1    2    
2    2    
3    3    

# simple avg
ok: select avg(x) from integers
$agg1
1.75 

# projection
ok: select x from booleans group by x order by x
x    
NULL 
false
true 

ok: select x from integers group by x order by x
x   
NULL
1   
2   
3   

ok: select x from dates group by x order by x
x         
NULL      
2000-01-01
2000-01-02
2000-01-03

ok: select x from timestamps group by x order by x
x                  
NULL               
2000-01-01 00:00:00
2000-01-02 00:00:00
2000-01-03 00:00:00

ok: select x from strings group by x order by x
x   
NULL
1   
2   
3   

ok: select booleans.x, integers.x from booleans, integers group by 1, 2 order by 1, 2
x     x   
NULL  NULL
NULL  1   
NULL  2   
NULL  3   
false NULL
false 1   
false 2   
false 3   
true  NULL
true  1   
true  2   
true  3   

ok: select distinct booleans.x, integers.x from booleans, integers order by 1, 2
x     x   
NULL  NULL
NULL  1   
NULL  2   
NULL  3   
false NULL
false 1   
false 2   
false 3   
true  NULL
true  1   
true  2   
true  3   

