select 1
from customer c1
where c1.customer_id in (select max(c2.customer_id) from customer c2 where c1.store_id = c2.store_id group by c2.account_number, c1.account_number)

Map $query.$col1:1
	HashJoin Semi (Equal customer.store_id customer.store_id') (Equal customer.account_number customer.account_number') (Equal customer.customer_id $aggregate.$agg1)
		Partition* customer.store_id' customer.account_number' $aggregate.$agg1
			Map $aggregate.$agg1 customer.store_id' customer.account_number'
				Aggregate $groupby.account_number $groupby.account_number customer.store_id' customer.account_number' $aggregate.$agg1:(Max $proj.$max)
					Map $groupby.account_number:customer.account_number $groupby.account_number:customer.account_number' $proj.$max:customer.customer_id customer.store_id' customer.account_number'
						HashJoin Inner (Equal customer.store_id' customer.store_id)
							Partition* customer.store_id'
								Aggregate customer.store_id' customer.account_number'
									Map* customer.customer_id customer.store_id' customer.account_number'
										SeqScan customer
							Partition* customer.store_id
								Map* customer.customer_id customer.store_id customer.account_number
									SeqScan customer
		Partition* customer.store_id customer.account_number customer.customer_id
			Map* customer.customer_id customer.store_id customer.account_number
				SeqScan customer