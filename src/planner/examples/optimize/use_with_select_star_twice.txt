with foo as (select * from customer) 
select f1.customer_id, f2.customer_id 
from foo f1, foo f2 
where f1.store_id = f2.store_id

LogicalWith foo
	Map* customer.customer_id customer.person_id customer.store_id customer.account_number customer.modified_date
		LogicalGet customer
	LogicalMap foo.customer_id foo.customer_id
		LogicalJoin Inner (Equal foo.store_id foo.store_id)
			LogicalGetWith foo
			LogicalGetWith foo

CreateTempTable foo
	Map* customer.customer_id customer.person_id customer.store_id customer.account_number customer.modified_date
		SeqScan customer
	Map foo.customer_id foo.customer_id
		HashJoin Inner foo.store_id=foo.store_id
			GetTempTable foo
			GetTempTable foo