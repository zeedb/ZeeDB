with foo as (select customer_id, store_id from customer) 
select f1.customer_id, f2.customer_id 
from foo f1, foo f2 
where f1.store_id = f2.store_id

LogicalWith foo
	LogicalProject customer.customer_id customer.store_id
		LogicalGet customer
	LogicalProject foo.customer_id foo.customer_id
		LogicalJoin Inner (Equal foo.store_id foo.store_id)
			LogicalGetWith foo
			LogicalGetWith foo

CreateTempTable foo
	Project customer.customer_id customer.store_id
		SeqScan customerProject foo.customer_id foo.customer_id
		HashJoin Inner foo.store_id=foo.store_id
			GetTempTable foo
			GetTempTable foo