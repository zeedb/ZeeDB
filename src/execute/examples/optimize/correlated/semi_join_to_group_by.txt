select 1
from customer c1
where c1.customer_id in (select max(c2.customer_id) from customer c2 where c1.store_id = c2.store_id group by c2.account_number)

Map $query.$col1:1
	HashJoin Semi (Equal customer.store_id customer.store_id') (Equal customer.customer_id $aggregate.$agg1)
		Partition* customer.store_id' $aggregate.$agg1
			Map $aggregate.$agg1 customer.store_id'
				Aggregate $groupby.account_number customer.store_id' $aggregate.$agg1:(Max $proj.$max)
					Map $groupby.account_number:customer.account_number $proj.$max:customer.customer_id customer.store_id'
						Map customer.store_id':customer.store_id, ..
							Filter* (LessOrEqual customer.$xmin (Xid)) (Less (Xid) customer.$xmax)
								Map* customer.customer_id customer.store_id customer.account_number customer.$xmin customer.$xmax
									SeqScan customer
		Partition* customer.store_id customer.customer_id
			Filter* (LessOrEqual customer.$xmin (Xid)) (Less (Xid) customer.$xmax)
				Map* customer.customer_id customer.store_id customer.$xmin customer.$xmax
					SeqScan customer