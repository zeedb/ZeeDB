select 1
from customer c1
where c1.customer_id in (select max(c2.customer_id) from customer c2 where c1.store_id = c2.store_id group by c2.account_number, c1.account_number)

Map $query.$col1:1
	HashJoin Semi (Equal customer.store_id store_id') (Equal customer.account_number account_number') (Equal customer.customer_id $aggregate.$agg1)
		Partition* store_id' account_number' $aggregate.$agg1
			Map $aggregate.$agg1 store_id' account_number'
				Aggregate $groupby.account_number $groupby.account_number store_id' account_number' $aggregate.$agg1:(Max $max)
					Map $groupby.account_number:customer.account_number $groupby.account_number:account_number' $max:customer.customer_id store_id' account_number'
						HashJoin Inner (Equal store_id' customer.store_id)
							Partition* store_id'
								Aggregate store_id' account_number'
									Filter* (LessOrEqual $xmin (Xid)) (Less (Xid) $xmax)
										Map* customer.customer_id store_id' account_number' $xmin $xmax
											SeqScan customer
							Partition* customer.store_id
								Filter* (LessOrEqual $xmin (Xid)) (Less (Xid) $xmax)
									Map* customer.customer_id customer.store_id customer.account_number $xmin $xmax
										SeqScan customer
		Partition* customer.store_id customer.account_number customer.customer_id
			Filter* (LessOrEqual $xmin (Xid)) (Less (Xid) $xmax)
				Map* customer.customer_id customer.store_id customer.account_number $xmin $xmax
					SeqScan customer