select customer_id
from (select *, account_number - 1 as prev_account_number from customer) c1
where person_id in (select person_id from customer c2 where c1.prev_account_number = c2.account_number)

Map customer.customer_id
	NestedLoop Semi (Equal c1.prev_account_number prev_account_number') (Equal customer.person_id customer.person_id)
		Map customer.person_id prev_account_number'
			Map prev_account_number':customer.account_number, ..
				Filter* (LessOrEqual $xmin (Xid)) (Less (Xid) $xmax)
					Map* customer.person_id customer.account_number $xmin $xmax
						SeqScan customer
		Map c1.prev_account_number:(Subtract customer.account_number 1) customer.customer_id customer.person_id customer.store_id customer.account_number customer.modified_date
			Filter* (LessOrEqual $xmin (Xid)) (Less (Xid) $xmax)
				Map* customer.customer_id customer.person_id customer.store_id customer.account_number customer.modified_date $xmin $xmax
					SeqScan customer